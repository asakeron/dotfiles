#!/usr/bin/env bash

trap 'trap - TERM; kill 0' INT TERM QUIT EXIT

declare -r status_bar_fifo="${XDG_RUNTIME_DIR}/status-bar-fifo"

[ -e "$status_bar_fifo" ] && rm "$status_bar_fifo"
mkfifo "$status_bar_fifo"

bspc subscribe report > "$status_bar_fifo" &

status_bar_content < "$status_bar_fifo" | lemonbar -g "x48" -f "Monospace" \
	                                           -a "10" -n "lemonbar" \
						   -u "4" -o "0" \
                                        | bash &

wait
