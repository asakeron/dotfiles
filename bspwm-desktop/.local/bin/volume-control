#!/usr/bin/env bash

set -eufo pipefail

# TODO: escrever usage

declare -r operand=${1:-"t"}
declare -r argument=${2:-"2"}

declare -r watcher_pipe="$XDG_RUNTIME_DIR/volume-watcher"

# TODO: verificar parÃ¢metros
# TODO: Como selecionar o sink?

case $operand in
  "+")
    pactl set-sink-mute 0 false
    pactl set-sink-volume 0 "+${argument}%"
    ;;
  "-")
    pactl set-sink-mute 0 false
    pactl set-sink-volume 0 "-${argument}%"
    ;;
  "t")
    pactl set-sink-mute 0 toggle
    ;;
esac

[[ -p $watcher_pipe ]] && pamixer --get-volume > $watcher_pipe

